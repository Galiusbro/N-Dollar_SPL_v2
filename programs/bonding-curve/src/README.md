# Bonding Curve - Реструктуризированный проект

## Структура проекта

```
bonding_curve/
├── lib.rs             # Точка входа программы, объявление модулей и инструкций
├── constants.rs       # Константы для бондинговой кривой
├── errors.rs          # Определения ошибок программы
├── state.rs           # Определения состояний (аккаунтов)
├── contexts/          # Контексты инструкций
│   ├── mod.rs         # Экспорт всех контекстов
│   ├── initialize.rs  # Контекст для инициализации
│   ├── trade.rs       # Контекст для торговых операций
│   └── price.rs       # Контекст для расчета цены
├── instructions/      # Реализация инструкций
│   ├── mod.rs         # Экспорт всех инструкций
│   ├── initialize.rs  # Инструкция инициализации
│   ├── trade.rs       # Инструкции купли-продажи
│   ├── price.rs       # Инструкции расчета цены
│   └── utils.rs       # Вспомогательные функции для инструкций
└── math/              # Математические функции
    └── mod.rs         # Функции для бондинговой кривой
```

## Описание модулей

### 1. `lib.rs`

Основной файл программы, содержит объявление ID программы, подключение модулей и определение инструкций (entrypoints).

### 2. `constants.rs`

Содержит все константы, используемые в программе (пределы, значения по умолчанию и т.д.).

### 3. `errors.rs`

Определяет все возможные ошибки программы.

### 4. `state.rs`

Содержит определение структуры данных `BondingCurve`, которая хранит состояние бондинговой кривой.

### 5. `contexts/`

Директория с контекстами (аккаунтами) для каждой инструкции:

- `initialize.rs`: Контекст для инициализации бондинговой кривой
- `trade.rs`: Контекст для операций купли-продажи токенов
- `price.rs`: Контекст для расчета цены и симуляции операций

### 6. `instructions/`

Директория с реализациями инструкций:

- `initialize.rs`: Логика инициализации бондинговой кривой
- `trade.rs`: Логика купли-продажи токенов
- `price.rs`: Логика расчета цены и симуляции
- `utils.rs`: Вспомогательные функции для инструкций

### 7. `math/`

Директория с математическими функциями для работы с бондинговой кривой:

- Расчет constant product
- Получение текущей цены
- Расчет количества токенов при покупке
- Расчет количества NDollar при продаже
- Расчет комиссии

## Выполненная реструктуризация

1. Разделены логические блоки:
   - Состояния и структуры данных
   - Контексты инструкций
   - Реализация инструкций
   - Математические функции
   - Константы и ошибки
2. Улучшена организация кода:
   - Каждый модуль отвечает за конкретный аспект программы
   - Уменьшен размер отдельных файлов
   - Улучшена навигация по коду
3. Сохранена вся функциональность:
   - Все инструкции работают так же, как и раньше
   - Логика осталась неизменной
   - Добавлены только необходимые импорты в каждый модуль
