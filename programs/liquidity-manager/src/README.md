# Liquidity Manager - Реструктуризированный проект

## Структура проекта

```
liquidity_manager/
├── lib.rs             # Точка входа программы, объявление модулей и инструкций
├── constants.rs       # Константы для проекта
├── errors.rs          # Определения ошибок программы
├── state.rs           # Определения состояний (аккаунтов)
├── contexts/          # Контексты инструкций
│   ├── mod.rs         # Экспорт всех контекстов
│   ├── initialize.rs  # Контекст для инициализации
│   ├── swap.rs        # Контекст для свопов
│   └── liquidity.rs   # Контекст для управления ликвидностью
├── instructions/      # Реализация инструкций
│   ├── mod.rs         # Экспорт всех инструкций
│   ├── initialize.rs  # Инструкция инициализации
│   ├── swap.rs        # Инструкции свопов
│   ├── liquidity.rs   # Инструкции управления ликвидностью
│   └── utils.rs       # Вспомогательные функции
```

## Описание модулей

### 1. `lib.rs`

Основной файл программы, содержит объявление ID программы, подключение модулей и определение инструкций (entrypoints).

### 2. `constants.rs`

Содержит все константы, используемые в программе:

- Максимальные размеры свопов
- Пороговые значения для защиты от манипуляций ценой
- Константы для цен и комиссий

### 3. `errors.rs`

Определяет все возможные ошибки программы.

### 4. `state.rs`

Содержит определение структуры данных `LiquidityManager`, которая хранит состояние пула ликвидности.

### 5. `contexts/`

Директория с контекстами (аккаунтами) для каждой инструкции:

- `initialize.rs`: Контекст для инициализации менеджера ликвидности
- `swap.rs`: Контексты для операций свопа SOL <-> N-Dollar
- `liquidity.rs`: Контекст для операций управления ликвидностью

### 6. `instructions/`

Директория с реализациями инструкций:

- `initialize.rs`: Логика инициализации менеджера ликвидности
- `swap.rs`: Логика свопов с защитой от проскальзывания и манипуляций
- `liquidity.rs`: Логика добавления и изъятия ликвидности
- `utils.rs`: Вспомогательные функции для инструкций

## Выполненная реструктуризация

1. Разделены логические блоки:
   - Состояния и структуры данных
   - Контексты инструкций
   - Реализация инструкций
   - Константы и ошибки
2. Улучшена организация кода:
   - Каждый модуль отвечает за конкретный аспект программы
   - Уменьшен размер отдельных файлов
   - Улучшена навигация по коду
   - Вынесены константы в отдельный модуль
3. Сохранена вся функциональность:
   - Все инструкции работают так же, как и раньше
   - Логика осталась неизменной
   - Добавлены только необходимые импорты в каждый модуль

## Дополнительные улучшения

1. Дополнительные константы:

   - Вынесены магические числа в константы
   - Улучшены наименования констант для большей читаемости

2. Улучшенная организация модулей:
   - Четкое разделение кода для свопов и управления ликвидностью
   - Логическое группирование функций
   - Обновленные импорты для большей читаемости
