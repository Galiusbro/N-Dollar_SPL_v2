# N-Dollar Token - Реструктуризированный проект

## Структура проекта

```
n_dollar_token/
├── lib.rs             # Точка входа программы, объявление модулей и инструкций
├── constants.rs       # Константы для проекта
├── errors.rs          # Определения ошибок программы
├── state.rs           # Определения состояний (аккаунтов)
├── contexts/          # Контексты инструкций
│   ├── mod.rs         # Экспорт всех контекстов
│   ├── initialize.rs  # Контекст для инициализации
│   ├── mint.rs        # Контекст для минтинга
│   ├── admin.rs       # Контекст для админ-функций
│   └── metadata.rs    # Контекст для управления метаданными
├── instructions/      # Реализация инструкций
│   ├── mod.rs         # Экспорт всех инструкций
│   ├── initialize.rs  # Инструкция инициализации токена
│   ├── mint.rs        # Инструкция минтинга
│   ├── admin.rs       # Инструкции административных функций
│   ├── metadata.rs    # Инструкции управления метаданными
│   ├── auth.rs        # Инструкции для управления подписями
│   └── utils.rs       # Вспомогательные функции
```

## Описание модулей

### 1. `lib.rs`

Основной файл программы, содержит объявление ID программы, подключение модулей и определение инструкций (entrypoints).

### 2. `constants.rs`

Содержит все константы, используемые в программе:

- Временные интервалы для минтинга
- Параметры безопасности и мультиподписи
- Настройки токена

### 3. `errors.rs`

Определяет все возможные ошибки программы.

### 4. `state.rs`

Содержит определение структуры данных `AdminAccount`, которая хранит состояние токена N-Dollar.

### 5. `contexts/`

Директория с контекстами (аккаунтами) для каждой инструкции:

- `initialize.rs`: Контекст для инициализации токена N-Dollar
- `mint.rs`: Контекст для минтинга новых токенов
- `admin.rs`: Контексты для административных функций
- `metadata.rs`: Контекст для обновления метаданных токена

### 6. `instructions/`

Директория с реализациями инструкций:

- `initialize.rs`: Логика инициализации токена N-Dollar
- `mint.rs`: Логика минтинга новых токенов с еженедельным расписанием
- `admin.rs`: Логика административных функций (сжигание, заморозка, разморозка)
- `metadata.rs`: Логика обновления метаданных токена
- `auth.rs`: Логика управления авторизованными подписантами
- `utils.rs`: Вспомогательные функции для проверки безопасности и авторизации

## Выполненная реструктуризация

1. Разделены логические блоки:
   - Состояния и структуры данных
   - Контексты инструкций
   - Реализация инструкций
   - Константы и ошибки
2. Улучшена организация кода:
   - Каждый модуль отвечает за конкретный аспект программы
   - Уменьшен размер отдельных файлов
   - Улучшена навигация по коду
   - Вынесены константы в отдельный модуль
3. Сохранена вся функциональность:
   - Все инструкции работают так же, как и раньше
   - Логика осталась неизменной
   - Добавлены только необходимые импорты в каждый модуль

## Особенности безопасности

- Реализован механизм мультиподписи для чувствительных операций
- Добавлена защита от манипуляций временем при минтинге
- Ограничение на частоту минтинга (раз в неделю)
- Интеграция с admin_control для дополнительной авторизации
